<%- include('partials/userheader.ejs') -%>
<!-- Breadcrumb Section Begin -->
<section class="breadcrumb-option">
  <div class="container">
      <div class="row">
          <div class="col-lg-12">
              <div class="breadcrumb__text">
                  <h4>About Us</h4>
                  <div class="breadcrumb__links">
                      <a href="/">Home</a>
                      <span>profile</span>
                  </div>
              </div>
          </div>
      </div>
  </div>
</section>
<!-- Breadcrumb Section End -->
<div><br>
        <section style="background-color: #eee;">
        <div class="container py-5">
          
      
          <div class="row">
            <div class="col-md-6 col-12">
              <div class="card mb-4">
                <div class="card-body text-center">
                  <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
                    class="rounded-circle img-fluid" style="width: 150px;">
                  <h5 class="my-3"><%- user.fullname %>  </h5>
                  <h4>Email  : <%- user.email %></h4>
                  <h4>Phone :<%- user.mobilenumber %></h4>
                  <div class="d-flex justify-content-center mb-2">
                    <button type="button" class="btn btn-success"  data-toggle="modal" data-target=".addprofile">ADD ADDRESS</button>
                  </div>
                </div>
              </div>
              
            </div>
            <!-- colapse -->
            <div class="col-md-6 col-12">
                <div class="card mb-4 mb-md-0" >
                    <div class="card-body ">
                                            
                        <p>
                                <a data-toggle="collapse" href="#collapseExample" >
                                  <button class="btn btn-info" style="width: 80%; margin-left: 50px;"> Show Address </button>
                                </a>
                                <div>
                                </div>
                                
                            </p>
                            <% if (useraddress) { %>
                             
                              <% for( let i = 0; i < findaddress.length; i++ ) { %>  
                              <div class="collapse" id="collapseExample">
                                  <div class="card card-body">
                                      <ul style="list-style-type: none;">
                                          <h4><li><%- findaddress[i].name -%> </li></h4><br>
                                          <li><%- findaddress[i].phone -%> </li>
                                          <li><%- findaddress[i].state -%> </li>
                                          <li><%- findaddress[i].city -%> </li>
                                          <li><%- findaddress[i].address -%> </li>
                                          <li><%- findaddress[i].pin -%> </li>
  
                                          <button class="btn btn-primary" > EDIT</button>
                                          <button class="btn btn-danger" onclick="deleteaddress('<%- findaddress[i]._id %>')"> DELETE</button>
                                      </ul>
                                  </div>
                              </div>
                              <% } %>
                              
                            <% }else{ %>
                              <h2>you dont have any address</h2>
                              <% } %>

                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>






        <!-- modal -->
<div class="modal fade addprofile" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
  
      <form action="/addprofile" method="post">
        <div class="col-lg-8" style="margin-left: 15%;">
          <div class="card mb-4">
            <div class="card-body">
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Full Name</p>
                </div>
                <div class="col-sm-9">
                  <input type="text" name="name">
                </div>
              </div>
              <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Phone</p>
                </div>
                <div class="col-sm-9">
                  <input type="number" name="phone">
                </div>
              </div>
              <hr>
              <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">State</p>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="state">
                  </div>
                </div>
                <hr>
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">City</p>
                </div>
                <div class="col-sm-9">
                  <input type="text" name="city">
                </div>
              </div>
              <hr>
              
              <div class="row">
                <div class="col-sm-3">
                  <p class="mb-0">Address</p>
                </div>
                <div class="col-sm-9">
                  <textarea name="address" id="" cols="30" rows="5"></textarea>
                </div>
              </div>
  
              <hr>
              <div class="row">
                  <div class="col-sm-3">
                    <p class="mb-0">Pin</p>
                  </div>
                  <div class="col-sm-9">
                    <input type="text" name="pin">
                  </div>
                </div>
                <hr>
  
                <button type="submit" class="btn btn-success">Add Address</button>
            </div>
          </div>
      </form>
      </div>
    </div>
  </div>
  </div>
  <!-- modal ends -->
      </section>

<!-- Modal -->
<!-- Modal -->
<% if (user_profile) { %>
  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">PROFILE</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
      </button>
  </div>
      <div class="modal-body">
        <div class="card-body text-center">
          <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
            class="rounded-circle img-fluid" style="width: 150px;">
          <h5 class="my-3"><%- user_profile.fullname %></h5>
          <p class="text-muted mb-1">E MAIL : <%- user_profile.email %></p>
          <p class="text-muted mb-4">MOBILE : <%- user_profile.mobilenumber %> </p>
          <div class="d-flex justify-content-center mb-2">
              <a href="/profile"><button type="button" class="btn btn-success">View Profile</button></a> 
              <a href="/order-success" class="mx-5"><button type="button" class="btn btn-success">your orders</button></a>
               
          </div>
      </div>
      <div class="modal-footer">
          <a href="/logout"><button type="button" class="btn btn-danger">Log Out</button></a>
      </div>
  </div>
</div>
</div>

<% }else{%>
  <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLongTitle">YOU ARE NOT LOGED IN NOW</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
          </button>
      </div>
      <h4 class="text-danger" style="text-align: center;"> Please Login</h4><br>
      <a href="/login" style="text-align: center;"><button type="button" class="btn btn-success">Log In</button></a>
  </div>
</div>
</div>

<%}%>  

  </div>
  

      <!-- <button type="button" class="btn btn-primary" data-toggle="modal" data-target=".bd-example-modal-lg">Large modal</button> -->
      <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>

async function deleteaddress(id){
       
       let add = await axios.delete(`/deleteaddress/${id}`)
        console.log(add)
        alert('are u sure u want to delete')
        location.reload()
    }
  </script>


<%- include('partials/userfooter.ejs') -%>
