<%- include ('partials/userheader.ejs') %>


<section class="breadcrumb-option">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="breadcrumb__text">
                    <h4>ORDER DETAIL</h4>
                    <!-- <div class="breadcrumb__links">
                        <a href="./index.html">Home</a>
                        <span>Shop</span>
                    </div> -->
                </div>
                <div class="justify-content-between">
                    <button class="float-right btn btn-warning" id="downloadinvoice">Download invoce</button>
                </div>
            </div>
        </div>
    </div>
</section>














<section class="confirmation_part padding_top" id="invoice">
    <div class="container" style="margin-top: 136px;">
      <div class="row">
        <div class="col-lg-12">
          <div class="confirmation_tittle" style="    justify-items: center;
          text-align: center;
          background-color: bisque;
          color: black;
          height: 25px;
          font-family: sans-serif;
          font-weight: 650;">
            <span>Thank you. Your order has been received.</span>
          </div>
        </div>
       
        <div class="col-lg-6 mt-5">
            
          <div class="single_confirmation_details" style="    background-color: aliceblue;">
            <h4 style=" color: black;
            font-weight: 700;
            padding-right: 24px;
            padding: 38px;">Order info</h4>
            <ul style="    margin-left: 36px; list-style-type: none;" >
              <li>
                <p>order number</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- orderdetail._id %> </span>
              </li>
              <li>
                <p>Date</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- orderdetail.orderdate.toLocaleDateString() %> </span>
              </li>
              <li>
                <p> Total</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- orderdetail.ordertotal %> INR </span>
              </li>
                     <li>
                <p>Payment Method</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">:  <%- orderdetail.paymentmethod %> </span>
              </li>

              <li>
                <p>Payment status</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- orderdetail.paymentstatus %> </span>
              </li>
            </ul>
          </div>
        </div>


        <div class="col-lg-6 mt-5">
          <div class="single_confirmation_details" style="    background-color: aliceblue;">
            <h4 style=" color: black;
            font-weight: 700;
            padding-right: 24px;
            padding: 38px;">Billing Address</h4>
            <ul style="    margin-left: 36px; list-style-type: none;">
              <li>
                <p>Address</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- selectedaddress.name %> <br><span style="margin-left: 167px;"><%- selectedaddress.address%></span> </span>
              </li>
              <li>
                <p>Phone</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">:  <%- selectedaddress.phone %>  </span>
              </li>
              <li>
                <p>City</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">:  <%- selectedaddress.city %>  </span>
              </li>
              <li>
                <p>State</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- selectedaddress.state %> </span>
              </li>
              <li>
                <p>Pincode</p><span style="    margin-left: 167px;
                top: -21px;
                position: relative;
                color: black;">: <%- selectedaddress.pin %> </span>
              </li>
            </ul>
          </div>
        </div>
       
       
      </div>
      <div class="row">
        <div class="col-lg-12 mt-5" style="    background-color: aliceblue;">
          <div class="order_details_iner">
            <h3 style="    padding: 26px; font-weight: 700;
            color: black;">Product Details</h3>
            <table class="table table-borderless" style="    margin-left: 17px;">
              <thead>
                <tr style="color: black;">
                  <th scope="col" colspan="2">Product</th>
                  <th scope="col">Quantity</th>
                  <th scope="col">Total</th>
                </tr>
              </thead>
              <tbody>
                
                <% orderdetail.orderitems.forEach(element => { %>
                <tr>
                  <td colspan="2"> <%- element.product.title %></td>
                  <td><%- element.quantity %></td>
                  <td><span> <%- element.product.price %> INR</span></td>
                </tr>
  
                
                <tr id="success_subtotal" style="color: black;">
                  <th colspan="3">product discount</th>
                  <th><%- element.product.discount %> INR</th>
                </tr>
                <!-- <tr style="color: black;">
                  <th colspan="3">Shipping</th>
                  <th></th>
                </tr> -->
                <% }) %>
              </tbody>
              <tfoot>
                <tr style="color: black;">
                  <th colspan="3">Grand Total</th>
                  <th><%- orderdetail.ordertotal %> INR</th>
                </tr>
              </tfoot>
            </table>
          </div>
             
        </div>
      </div>
    </div>
    <br>
  </section>
  <br><br>



  <!-- Modal -->
  <% if (user_profile) { %>
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">PROFILE</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span>
        </button>
    </div>
        <div class="modal-body">
          <div class="card-body text-center">
            <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-chat/ava3.webp" alt="avatar"
              class="rounded-circle img-fluid" style="width: 150px;">
            <h5 class="my-3"><%- user_profile.fullname %></h5>
            <p class="text-muted mb-1">E MAIL : <%- user_profile.email %></p>
            <p class="text-muted mb-4">MOBILE : <%- user_profile.mobilenumber %> </p>
            <div class="d-flex justify-content-center mb-2">
                <a href="/profile"><button type="button" class="btn btn-success">View Profile</button></a> 
                <a href="/order-success" class="mx-5"><button type="button" class="btn btn-success">your orders</button></a>
                 
            </div>
        </div>
        <div class="modal-footer">
            <a href="/logout"><button type="button" class="btn btn-danger">Log Out</button></a>
        </div>
    </div>
</div>
</div>

<% }else{%>
    <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="exampleModalLongTitle">YOU ARE NOT LOGED IN NOW</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
        </div>
        <h4 class="text-danger" style="text-align: center;"> Please Login</h4><br>
        <a href="/login" style="text-align: center;"><button type="button" class="btn btn-success">Log In</button></a>
    </div>
</div>
</div>

  <%}%>  

</div>

 





















<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js" integrity="sha512-GsLlZN/3F2ErC5ifS5QtgpiJtWd43JWSuIgh7mbzZ8zBps+dvLusV+eNQATqgA/HdeKFVgA5v3S/cIrLF7QnIg==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
const button = document.getElementById('downloadinvoice')
function generatePDF(){
    const element = document.getElementById('invoice')
    html2pdf().from(element).save()
}
button.addEventListener('click',generatePDF)
</script>
<%- include ('partials/userfooter.ejs') %>